import{r as o,u as S,l as a,j as e}from"./index-BhYCAuGP.js";function b(){const i=new URL(window.location.href),s=i.searchParams.get("bid");if(s)return s;const r=i.searchParams.get("liff.state");if(r)try{return new URL(r,window.location.origin).searchParams.get("bid")}catch{}return null}function u(i,s){const r=new URL(i,window.location.origin);return s&&r.searchParams.set("bid",s),`${r.pathname}${r.search}${r.hash}`}const I="2008002745-KgmzwRd4";function T(){const[i,s]=o.useState(!1),[r,c]=o.useState(!1),[t,p]=o.useState(null),[x,f]=o.useState(null),[d,y]=o.useState(null),h=S();o.useEffect(()=>{const R=b();a.init({liffId:I}).then(async()=>{const l=a.isLoggedIn();if(c(l),l)try{const n=await a.getProfile();p(n)}catch(n){f(String(n))}const g=b()??R??null;if(y(g),g){const n=new URL(location.href);n.searchParams.get("bid")||n.searchParams.set("bid",g),n.searchParams.has("liff.state")&&n.searchParams.delete("liff.state"),history.replaceState(null,"",n.toString())}}).catch(l=>f(`LIFF init failed: ${l}`)).finally(()=>s(!0))},[]);const m=async()=>{if(i){if(!r){a.login();return}a.logout(),c(!1),p(null)}},j=()=>{h(u("/batteryInfo",d),{replace:!1})},w=()=>{h(u("/scan",d),{replace:!1})},k=()=>{},P=()=>{h(u("/currentLocation",d),{replace:!1})};return e.jsx(e.Fragment,{children:e.jsxs("main",{style:{maxWidth:560,margin:"40px auto",padding:24},children:[e.jsx("h1",{children:"LIFF 로그인 테스트"}),!i&&e.jsx("p",{children:"초기화 중…"}),i&&e.jsxs(e.Fragment,{children:[e.jsx("section",{style:{margin:"16px 0"},children:e.jsx("button",{onClick:m,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:r?"로그아웃":"로그인"})}),x&&e.jsx("p",{style:{color:"red",whiteSpace:"pre-wrap"},children:x}),e.jsxs("section",{style:{marginTop:16},children:[e.jsx("h2",{children:"상태"}),e.jsx("p",{children:r?"로그인 상태":"로그아웃 상태"})]}),r&&t&&e.jsxs("section",{style:{marginTop:16},children:[e.jsx("h2",{children:"프로필"}),t.pictureUrl?e.jsx("img",{src:t.pictureUrl,alt:`${t.displayName}의 프로필 이미지`,width:96,height:96,style:{width:96,height:96,borderRadius:"50%",objectFit:"cover"},loading:"lazy",referrerPolicy:"no-referrer"}):e.jsx("div",{"aria-label":"프로필 이미지 없음",style:{width:96,height:96,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:24,background:"#eee",color:"#555"},children:t.displayName?.[0]??"?"}),e.jsx("p",{style:{marginTop:8},children:e.jsx("strong",{children:t.displayName})}),t.statusMessage&&e.jsx("p",{children:t.statusMessage}),e.jsxs("p",{style:{color:"#666",marginTop:4},children:["ID: ",t.userId]})]}),e.jsx("div",{style:{marginTop:16},children:e.jsx("button",{onClick:j,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:"배터리 정보 페이지로 이동"})}),e.jsx("div",{style:{marginTop:16},children:e.jsx("button",{onClick:w,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:"Scan 페이지로 이동"})}),e.jsx("div",{style:{marginTop:16},children:e.jsx("button",{onClick:k,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:"임시 페이지들로 이동"})}),e.jsx("div",{style:{marginTop:16},children:e.jsx("button",{onClick:P,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:"위치 조회 페이지로 이동"})}),e.jsxs("section",{style:{marginTop:16},children:[e.jsx("h2",{children:"UserAgent"}),e.jsx("pre",{style:{fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-all",padding:"8px",borderRadius:"4px"},children:navigator.userAgent})]})]})]})})}export{T as default};
