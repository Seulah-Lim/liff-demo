import{r as a,u as R,l as o,j as e}from"./index-BvCErcIC.js";function m(){const s=new URL(window.location.href),i=s.searchParams.get("bid");if(i)return i;const r=s.searchParams.get("liff.state");if(r)try{return new URL(r,window.location.origin).searchParams.get("bid")}catch{}return null}function p(s,i){const r=new URL(s,window.location.origin);return i&&r.searchParams.set("bid",i),`${r.pathname}${r.search}${r.hash}`}const S="2008002745-KgmzwRd4";function U(){const[s,i]=a.useState(!1),[r,c]=a.useState(!1),[t,u]=a.useState(null),[f,x]=a.useState(null),[d,b]=a.useState(null),h=R();a.useEffect(()=>{console.log("UserAgent:",navigator.userAgent);const P=m();o.init({liffId:S}).then(async()=>{const l=o.isLoggedIn();if(c(l),l)try{const n=await o.getProfile();u(n)}catch(n){x(String(n))}const g=m()??P??null;if(b(g),g){const n=new URL(location.href);n.searchParams.get("bid")||n.searchParams.set("bid",g),n.searchParams.has("liff.state")&&n.searchParams.delete("liff.state"),history.replaceState(null,"",n.toString())}}).catch(l=>x(`LIFF init failed: ${l}`)).finally(()=>i(!0))},[]);const y=async()=>{if(s){if(!r){o.login();return}o.logout(),c(!1),u(null)}},j=()=>{h(p("/batteryInfo",d),{replace:!1})},w=()=>{h(p("/scan",d),{replace:!1})},k=()=>{h(p("/temp",d),{replace:!1})};return e.jsx(e.Fragment,{children:e.jsxs("main",{style:{maxWidth:560,margin:"40px auto",padding:24},children:[e.jsx("h1",{children:"LIFF 로그인 테스트"}),!s&&e.jsx("p",{children:"초기화 중…"}),s&&e.jsxs(e.Fragment,{children:[e.jsx("section",{style:{margin:"16px 0"},children:e.jsx("button",{onClick:y,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:r?"로그아웃":"로그인"})}),f&&e.jsx("p",{style:{color:"red",whiteSpace:"pre-wrap"},children:f}),e.jsxs("section",{style:{marginTop:16},children:[e.jsx("h2",{children:"상태"}),e.jsx("p",{children:r?"로그인 상태":"로그아웃 상태"})]}),r&&t&&e.jsxs("section",{style:{marginTop:16},children:[e.jsx("h2",{children:"프로필"}),t.pictureUrl?e.jsx("img",{src:t.pictureUrl,alt:`${t.displayName}의 프로필 이미지`,width:96,height:96,style:{width:96,height:96,borderRadius:"50%",objectFit:"cover"},loading:"lazy",referrerPolicy:"no-referrer"}):e.jsx("div",{"aria-label":"프로필 이미지 없음",style:{width:96,height:96,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:24,background:"#eee",color:"#555"},children:t.displayName?.[0]??"?"}),e.jsx("p",{style:{marginTop:8},children:e.jsx("strong",{children:t.displayName})}),t.statusMessage&&e.jsx("p",{children:t.statusMessage}),e.jsxs("p",{style:{color:"#666",marginTop:4},children:["ID: ",t.userId]})]}),e.jsx("div",{style:{marginTop:16},children:e.jsx("button",{onClick:j,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:"배터리 정보 페이지로 이동"})}),e.jsx("div",{style:{marginTop:16},children:e.jsx("button",{onClick:w,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:"Scan 페이지로 이동"})}),e.jsx("div",{style:{marginTop:16},children:e.jsx("button",{onClick:k,style:{padding:"10px 16px",backgroundColor:"black",color:"white",border:"none",borderRadius:6,cursor:"pointer"},children:"임시 페이지들로 이동"})}),e.jsxs("section",{style:{marginTop:16},children:[e.jsx("h2",{children:"UserAgent"}),e.jsx("pre",{style:{fontSize:"12px",whiteSpace:"pre-wrap",wordBreak:"break-all",padding:"8px",borderRadius:"4px"},children:navigator.userAgent})]})]})]})})}export{U as default};
